/**
 * Minified by jsDelivr using Terser v5.3.5.
 * Original file: /npm/cryp@0.1.1/Cryp.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var crypto=require("crypto");function Cryp(r){this.keys=[].concat(r)}Cryp.prototype={encrypt:function(r,e){r.constructor!=Buffer&&(r=new Buffer(String(r)));var t=this.keys[0],n=crypto.randomBytes(12),c=crypto.createCipheriv("aes-256-gcm",t,n);return r=Buffer.concat([c.update(r),c.final(),c.getAuthTag(),n]),e?r.toString(e):r},decrypt:function(r,e,t){r.constructor!=Buffer?r=new Buffer(r,e):t||(t=e);var n=r.slice(-12),c=r.slice(-28,-12);r=r.slice(0,-28);try{for(var u=0;u<this.keys.length;u++){var i=this.keys[u],o=crypto.createDecipheriv("aes-256-gcm",i,n);o.setAuthTag(c);try{r=Buffer.concat([o.update(r),o.final()])}catch(r){continue}return t?r.toString(t):r}}catch(r){return null}return null},sign:function(r){r.constructor!=Buffer&&(r=new Buffer(String(r)));var e=base64url.encode(this.getSign(r));return r.toString()+e},unsign:function(r){var e=base64url.decode(r.slice(-38));return r=r.slice(0,-38),this.verify(r,e)?r:null},getSign:function(r,e){r.constructor!=Buffer&&(r=new Buffer(String(r)));var t=this.keys[0],n=crypto.createHmac("sha224",t).update(r).digest();return e?n.toString(e):n},verify:function(r,e,t){r.constructor!=Buffer&&(r=new Buffer(String(r))),e.constructor!=Buffer&&(e=new Buffer(e,t));for(var n=0;n<this.keys.length;n++){var c=this.keys[n];if(e.equals(crypto.createHmac("sha224",c).update(r).digest()))return!0}return!1}};var base64url={encode:function(r){return r.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},decode:function(r){return new Buffer(r.replace(/-/g,"+").replace(/_/g,"/"),"base64")}};module.exports=Cryp;
//# sourceMappingURL=/sm/1bee968bbf04d12eea0ca79e1508aca323778e7c129bb820933179d8635151cd.map